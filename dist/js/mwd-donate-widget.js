"use strict";(function(){window.console&&console.log("mwd-donate-widget.js v18.7.27"),window.mwdspace=window.mwdspace||{},window.mwdspace.MFA_Funraise_Widget=function(e){var n=this;if("undefined"==typeof e)var e={};n.isStarted=!1,n.isLoaded=!1,n.allowAutoScroll=!1,n.codeVersion="1.0.0",n.domTargetElement={},n.promises={},n.intervals={},n.urls={},n.defaults={},n.options={},n.setSystemValues(),n.setUserOptions(e);var t=document.querySelectorAll(n.options.element);return t?1<t.length?(window.console&&console.warn("MFA_Funraise_Widget(): using 1st of multiple target elemets found:",n.options.element),!1):void(n.domTargetElement=t[0]):(window.console&&console.error("MFA_Funraise_Widget(): specified target element not found:",n.options.element),!1)},window.mwdspace.MFA_Funraise_Widget.prototype.setSystemValues=function(){var e=this;e.urls.base="https://quiz.mercyforanimals.org/donate-widget/"+e.codeVersion+"/",e.urls.fontAwesome4="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css",e.urls.fontAwesome5="https://use.fontawesome.com/releases/v5.1.0/css/all.css",e.urls.specialSelectStyles="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css",e.urls.specialSelectScript="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.min.js",e.urls.spreedlyScript="https://core.spreedly.com/iframe/iframe-v1.min.js",e.urls.jqueryScript="https://code.jquery.com/jquery-3.3.1.min.js",e.urls.companyMatchApi="https://platform.funraise.io/api/v1/ddcompanies",e.urls.bitcoinPaymentApi="https://bitpay.com/",e.urls.testBitcoinPaymentApi="https://test.bitpay.com/",e.defaults.organizationId="fcb4d538-ca92-4212-86cc-06d8ac929c4d",e.defaults.formId=1194,e.defaults.paymentTokenApiKey="KvcTOx3FPBgscLs51rjT848DP7p",e.defaults.testPaymentTokenApiKey="ECDNSGhIR0fYQisIc1PHH7NX0pN",e.defaults.minimumGiftAmount=5,e.defaults.giftStringSingle=[25,50,75,100],e.defaults.giftStringMonthly=[5,10,15,20],e.defaults.currencyCode="USD",e.defaults.topVisualPaddingSelector="section#header",e.payMethodIconHtml={card:"<i class=\"fa far fa-credit-card\" aria-hidden=\"true\"></i>",visa:"<i class=\"fa fab fa-cc-visa\" aria-hidden=\"true\"></i>",mastercard:"<i class=\"fa fab fa-cc-mastercard\" aria-hidden=\"true\"></i>",amex:"<i class=\"fa fab fa-cc-amex\" aria-hidden=\"true\"></i>",discover:"<i class=\"fa fab fa-cc-discover\" aria-hidden=\"true\"></i>",bitcoin:"<i class=\"fa fab fa-bitcoin fa-btc\" aria-hidden=\"true\"></i>"}},window.mwdspace.MFA_Funraise_Widget.prototype.setUserOptions=function(e){var n=this;if("undefined"==typeof e)var e={};if("string"==typeof e.baseUrlOverride&&e.baseUrlOverride.trim()&&(n.urls.base=encodeURI(e.baseUrlOverride),"/"!=n.urls.base.substr(-1)&&(n.urls.base+="/")),"string"==typeof e.element&&e.element.trim())n.options.element=e.element;else return window.console&&console.error("MFA_Funraise_Widget(): invalid options - No target element:",e),!1;n.options.organizationId="undefined"==typeof e.organizationId?n.defaults.organizationId:e.organizationId,n.options.formId="undefined"==typeof e.formId?n.defaults.formId:e.formId,n.options.paymentTokenApiKey="undefined"==typeof e.paymentTokenApiKey?n.defaults.paymentTokenApiKey:e.paymentTokenApiKey,n.options.giftStringSingle="object"==typeof e.giftStringSingle&&0<e.giftStringSingle.length?e.giftStringSingle:n.defaults.giftStringSingle,n.options.giftStringMonthly="object"==typeof e.giftStringMonthly&&0<e.giftStringMonthly.length?e.giftStringMonthly:n.defaults.giftStringMonthly,n.options.defaultCurrency=!!("string"==typeof e.defaultCurrency&&e.defaultCurrency.trim())&&e.defaultCurrency,n.options.filterListCurrency="object"==typeof e.currencies&&e.currencies,n.options.defaultPayMethod=!!("string"==typeof e.defaultPayMethod&&e.defaultPayMethod.trim())&&e.defaultPayMethod,n.options.filterListPayMethod="string"==typeof e.payMethods&&e.payMethods.trim()?[e.payMethods]:!!(e.payMethods&&e.payMethods.constructor===Array&&0<e.payMethods.length)&&e.payMethods,n.options.defaultFrequency=!!("string"==typeof e.defaultFrequency&&e.defaultFrequency.trim())&&e.defaultFrequency,n.options.filterListFrequency="string"==typeof e.frequencies&&e.frequencies.trim()?[e.frequencies]:!!(e.frequencies&&e.frequencies.constructor===Array&&0<e.frequencies.length)&&e.frequencies,n.options.fontAwesomeVersion="undefined"==typeof e.fontAwesomeVersion?4:isNaN(e.fontAwesomeVersion)?null:parseInt(e.fontAwesomeVersion),n.options.includeCompanyMatch=!1!==e.includeCompanyMatch,n.options.includeExtraPercent=!1!==e.includeExtraPercent,n.options.labelOverrideObject=!1,n.options.labelOverrideFileUrl=!1,"string"==typeof e.labelOverride&&e.labelOverride.trim()?n.options.labelOverrideFileUrl=e.labelOverride:"object"==typeof e.labelOverride&&(n.options.labelOverrideObject=e.labelOverride),n.options.onLoad="function"==typeof e.onLoad&&e.onLoad,n.options.onDonation="function"==typeof e.onDonation&&e.onDonation},window.mwdspace.MFA_Funraise_Widget.prototype.start=async function(){var e=this;if(e.isStarted)return void(window.console&&console.warn("MFA_Funraise_Widget already started"));e.isStarted=!0,e.domTargetElement.innerHTML="";var n=e.getFontIconStyles(),t=e.linkExternalStylesheet(e.urls.base+"css/mwd-donate-widget.css");e.linkExternalStylesheet(e.urls.specialSelectStyles),await Promise.all([n,t]);var o,i,a=e.loadFile(e.urls.base+"mwd-donate-widget.html"),r=e.linkExternalScript(e.urls.base+"js/shared-utils.js");if([o,i]=await Promise.all([a,r]),!o)return void(window.console&&console.error("MFA_Funraise_Widget.start() - unable to load base HTML"));var d=document.createElement("div");d.id="mfaDonationWidgetContainer",d.style.opacity=0,e.domTargetElement.appendChild(d),d.innerHTML=o,setTimeout(function(){d.className="reveal"},1),e.promises.spreedlyIframeScript=e.linkExternalScript(e.urls.spreedlyScript);var s=await e.linkExternalScript(e.urls.jqueryScript),l=e.linkExternalScript(e.urls.specialSelectScript),c=e.linkExternalScript(e.urls.base+"js/gift-utilities.js"),u=e.linkExternalScript(e.urls.base+"js/transaction-system-layer.js");await Promise.all([c,u,l]),e.jquery=s?jQuery.noConflict():$||{},e.run()},window.mwdspace.MFA_Funraise_Widget.prototype.run=async function(){function e(){switch(mwdspace.currentStepName){case"giftAmount":if(o())return t("donorInfo"),!0;break;case"donorInfo":if(i())return"card"==window.mwdspace.userInputData.payMethod?(t("cardInfo"),!0):(b(),w());break;case"cardInfo":if(a())return b(),D();}return!1}function n(){switch(mwdspace.currentStepName){case"donorInfo":t("giftAmount");break;case"cardInfo":t("donorInfo");}}function t(e){window.mwdspace.currentStepName="",e=window.mwdspace.sharedUtils.ensureString(e),e||(e=window.mwdspace.sharedUtils.getSessionValue("savedStepName"),!e&&(e="giftAmount")),Q.find("div.loadingDisplay").hide();for(var n,t=0;t<X.length;t++)if(n=X[t].getAttribute("data-step-name"),n==e){if("donorInfo"===e||"cardInfo"===e?(Q.find("div.giftFormHeaderContainer").show(),ee.fadeIn(888)):ee.hide(),"donorInfo"==e){var o;switch(window.mwdspace.userInputData.payMethod){case"card":window.console&&console.warn("Making next button"),o="Enter Payment Information";try{z.labelOverride.button.goPaymentInfo&&(o=z.labelOverride.button.goPaymentInfo)}catch(e){}break;case"bitcoin":window.console&&console.warn("Making submit button"),o="Submit Donation";try{z.labelOverride.button.mainSubmit&&(o=z.labelOverride.button.mainSubmit)}catch(e){}}z.setElementLabelOverride("button.goPaymentInfo",o)}K(X[t]).fadeIn(666,function(){G(Q)}),window.mwdspace.currentStepName=n,"confirmation"==e&&window.mwdspace.sharedUtils.removeSessionValue("savedStepName")}else K(X[t]).hide()}function o(){var e=!0;if("number"!=typeof J.baseAmount||J.baseAmount<z.currentGiftMinimum){window.console&&console.warn("baseAmount is invalid",J.baseAmount),e=!1;var n="Please enter an amount of at least";try{n=z.labelOverride.gift.error.invalidAmount||n}catch(e){}n+=" "+z.currentCurrencySymbol+z.currentGiftMinimum,r("giftAmount",n,!0)}else r("giftAmount");return"string"!=typeof J.giftCurrency&&(window.console&&console.warn("Currency is invalid",J.giftCurrency),e=!1),"string"!=typeof J.payMethod&&(window.console&&console.warn("Pay Method is invalid",J.payMethod),e=!1),"string"!=typeof J.giftFrequency&&(window.console&&console.warn("Gift frequency is invalid",J.giftFrequency),e=!1),e}function i(){var e=!0;return Q.find("section.step[data-step-name='donorInfo'] .changeWatch").each(function(){"donorCountry"!=K(this).attr("name")&&"none"!=K(this).css("display")&&K(this).trigger("change")}),J.donorCountry=Q.find("div.billingInfoContainer select[name='donorCountry']").val()||null,"string"!=typeof J.donorFirstName&&(window.console&&console.warn("donorFirstName is invalid",J.donorFirstName),e=!1),"string"!=typeof J.donorLastName&&(window.console&&console.warn("donorLastName is invalid",J.donorLastName),e=!1),"string"!=typeof J.donorEmail&&(window.console&&console.warn("donorEmail is invalid",J.donorEmail),e=!1),"undefined"!=typeof J.donorPhone&&"string"!=typeof J.donorPhone&&(window.console&&console.warn("donorPhone is invalid",J.donorPhone),e=!1),"string"!=typeof J.donorStreet&&(window.console&&console.warn("donorStreet is invalid",J.donorStreet),e=!1),"string"!=typeof J.donorRegion&&(window.console&&console.warn("donorRegion is invalid",J.donorRegion),e=!1),"string"!=typeof J.donorPostCode&&(window.console&&console.warn("donorPostCode is invalid",J.donorPostCode),e=!1),"string"!=typeof J.donorCountry&&(window.console&&console.warn("donorCountry is invalid",J.donorCountry),e=!1),"on"==J.companyMatch&&("string"!=typeof J.donorMatchCompany&&(window.console&&console.warn("donorMatchCompany is invalid",J.donorMatchCompany),e=!1),"string"!=typeof J.donorMatchEmail&&(window.console&&console.warn("donorMatchEmail is invalid",J.donorMatchEmail),e=!1)),e}function a(){var e=!0;Q.find("section.step[data-step-name='cardInfo'] .changeWatch").trigger("change");var n=Q.find("div.payInfoContainer div#cardNumberTarget");!0===J.hasValidCardNumber?n.removeClass("invalid"):(e=!1,n.addClass("invalid"),window.console&&console.warn("hasValidCardNumber is invalid",J.hasValidCardNumber));var t=Q.find("div.payInfoContainer div#cardCvvTarget");return!0===J.hasValidCardCvv?t.removeClass("invalid"):(e=!1,t.addClass("invalid"),window.console&&console.warn("hasValidCardCvv is invalid",J.hasValidCardCvv)),"string"!=typeof J.payCardExpireMonth&&(window.console&&console.warn("payCardExpireMonth is invalid",J.payCardExpireMonth),e=!1),"string"!=typeof J.payCardExpireYear&&(window.console&&console.warn("payCardExpireYear is invalid",J.payCardExpireYear),e=!1),e}function r(e,n,t){if("undefined"==typeof e)var e="";if("undefined"==typeof n)var n="";if("undefined"==typeof t)var t=!1;!e&&window.console&&console.log("showStepFeedback() given invalid input",e,n);var o=K("section[data-step-name=\""+e+"\"] div.userFeedback p.message");n||t?(o.html(n||"Sorry, an unknown error occured").fadeIn(444),t?o.addClass("error"):o.removeClass("error")):o.fadeOut(222,function(){K(this).html(""),K(this).removeClass("error")})}function d(e,n){if("undefined"==typeof n)var n={};var t=!0,o=null;if(n.validationPattern=e.attr("data-validation"),n.validationPattern&&(t=s(e,n)),t){var i=e.attr("type");"checkbox"==i||"radio"==i?e.prop("checked")&&(o=n.value):o=n.value}J[n.name]=o,window.mwdspace.sharedUtils.setLocalValue(n.name,n.value,{prefix:!1})}function s(e,n){if("undefined"==typeof n)var n={};var t=!0,o="";switch("undefined"!=typeof n.value&&null!==n.value&&(o=n.value+""),n.validationPattern){case"email":t=o.match(/^[\w|\.|\-|\_]+@[\w|\.|\-|\_]+\.[a-z]{2,}$/i);break;default:var i=new RegExp(n.validationPattern,"i");t=o.match(i);}return t?(e.removeClass("invalid"),!0):(e.addClass("invalid"),!1)}function l(e){var n=K(e.target),t=M(n.val())||0;if(c({baseAmount:t}),Q.find("div.giftOption input").removeClass("selected"),n.addClass("selected"),"change"==e.type&&Z.slideDown(666,function(){G(Q)}),"change"==e.type||"blur"==e.type){if("giftAmountFreeform"==n.attr("name")){var o=M(t)||0,i=o.toFixed(2);i!=t&&n.val(i)}o<z.currentGiftMinimum?ne.addClass("invalid"):ne.removeClass("invalid"),Q.find("div.giftOption input[type='radio']").prop("checked",!1)}}function c(e){if("undefined"==typeof e)var e={};try{J.totalAmount=J.totalAmount||0,J.baseAmount=J.baseAmount||0,J.extraAmount=J.extraAmount||0,J.extraPercent=J.extraPercent||0,"undefined"!=typeof e.baseAmount&&(J.baseAmount=parseFloat(e.baseAmount)||0),"undefined"!=typeof e.extraPercent&&(J.extraPercent=parseFloat(e.extraPercent)||0),J.extraAmount=J.baseAmount*J.extraPercent/100,J.totalAmount=J.baseAmount+J.extraAmount;var n=J.totalAmount.toFixed(2).split(".");Q.find("div.amountDisplay span.displayWholeAmount").text(n[0]||"??"),Q.find("div.amountDisplay span.displaySubAmount").text("."+n[1]||"??")}catch(e){window.console&&console.log("updateGiftAmount() caught error: ",e.message)}}function u(){for(var e,n=ae.val(),t="(?)",o=0;o<window.mwdspace.validCurrencyList.length;o++)if(e=window.mwdspace.validCurrencyList[o],z.currentGiftMinimum=e.minimumAmount,e.code==n&&e.symbol){t=e.symbol;break}z.currentCurrencySymbol=t,Q.find("span.currencySymbol").html(t)}function p(){for(var e,n=te.val(),t=0;t<window.mwdspace.validPayMethodList.length;t++)if(e=window.mwdspace.validPayMethodList[t],e.code==n){e.frequencies&&m(e.frequencies);break}}function m(e){if("object"!=typeof e||1>e.length)return void(window.console&&console.warn("setFrequencyButtonVisibility() ignoring invalid frequency list",e));var n,t=[],o=0,a=!1;if(Q.find("div.giftFrequencyContainer div.fancyRadioButton input[type='radio']").each(function(){n={jqObject:K(this),show:!0},0<=e.indexOf(n.jqObject.val())?o++:(n.show=!1,n.jqObject.prop("checked")&&(a=!0)),t.push(n)}),1>o)Q.find("div.giftFrequencyContainer div.fancyRadioButton").show();else if(1==o)Q.find("div.giftFrequencyContainer div.fancyRadioButton").hide();else for(var r=0;r<t.length;r++)t[r].show?t[r].jqObject.closest("div.fancyRadioButton").show():t[r].jqObject.closest("div.fancyRadioButton").hide();if(a)for(var r=0;r<t.length;r++)if(t[r].show){t[r].jqObject.prop("checked",!0).trigger("change");break}}function f(e){if("undefined"==typeof e)var e=null;var n;switch(e){case"single":n="Your donation";try{z.labelOverride.header.singleDonationText&&(n=z.labelOverride.header.singleDonationText)}catch(e){}break;case"monthly":n="Your recurring donation";try{z.labelOverride.header.monthlyDonationText&&(n=z.labelOverride.header.monthlyDonationText)}catch(e){}break;default:n="UNKNOWN DONATION FREQUENCY";}z.setElementLabelOverride("header.donationText",n),C()}function g(e,n){h(e,n)||y(n)}function h(e,n){if("undefined"==typeof e||!e)return void(window.console&&console.log("setInputFromUrl() given invalid urlKey",e));if("undefined"==typeof n||!n)return void(window.console&&console.log("setInputFromUrl() given invalid selector",n));var t=window.mwdspace.sharedUtils.getUrlParameter(e);return!!t&&v(n,t)}function y(e){if("undefined"==typeof e||!e)return void(window.console&&console.log("setInputFromStorage() given invalid selector",e));var n=window.mwdspace.sharedUtils.getLocalValue(e,{prefix:!1});return!!n&&v(e,n)}function v(e,n){if("undefined"==typeof e||!e)return void(window.console&&console.log("setInputValue() given invalid selector",e));var t=Q.find("section.step input[name='"+e+"'], section.step select[name='"+e+"']");return!!(0<t.length)&&(t.val(n).trigger("change"),!0)}function b(){try{window.mwdspace.transactionSendData={};var e=window.mwdspace.transactionSendData,n=window.mwdspace.userInputData;switch(e.organizationId=z.options.organizationId||null,e.formId=z.options.formId?z.options.formId+"":"",e.formAllocationId=z.options.formAllocationId||null,e.bank_account_holder_type="personal",e.bank_account_number="",e.bank_account_type="checking",e.bank_name="",e.bank_routing_number="",e.comment="",e.payment_method_token="",e.tags=null,e.first_name=n.donorFirstName||"",e.last_name=n.donorLastName||"",e.email=n.donorEmail||"",e.phone=n.donorPhone||"",e.address=n.donorStreet||"",e.city=n.donorCity||"",e.state=n.donorRegion||"",e.postalCode=n.donorPostCode||"",e.country=n.donorCountry||"",e.amount=n.totalAmount||0,e.baseAmount=(+(n.baseAmount||0)).toFixed(2),e.tipAmount=(+(n.extraAmount||0)).toFixed(2),e.tipPercent=(+(n.extraPercent||0)).toFixed(2),n.giftFrequency){case"single":e.recurring=!1,e.frequency="o";break;case"monthly":e.recurring=!0,e.frequency="m";break;default:e.recurring=null,e.frequency="";}return e.currency=n.giftCurrency||"",e.paymentType=n.payMethod||"","card"==e.paymentType&&(e.month=n.payCardExpireMonth||"",e.year=n.payCardExpireYear||""),e.donateDouble=!0===n.isCompanyMatch,e.company=n.companyMatchName||"",e.employeeEmail=n.companyMatchEmail||"",!0}catch(e){window.console&&console.warn("buildTransactionSendData() caught error: ",e.message)}return!1}function w(){return!!window.mwdspace.transactionLayer.validateSendData(window.mwdspace.transactionSendData)&&(R(),window.mwdspace.transactionLayer.startDonation(window.mwdspace.transactionSendData,function(e){var n=e.json||{};if(window.console&&console.log("transactionData",n),"bitcoin"==n.type)V(n);else{var t=n.status+"";t.match(/complete/i)?B():Y("The server appears to have had an error processing this card transaction, and reported status \""+t+"\".")}},function(e){window.console&&console.warn("Donation received fail response from server",e);var n;if(e.text){n="Server message:";try{n=z.labelOverride.transactionError.error.systemMessage||n}catch(e){}n+=" "+e.text}else{n="The server was unable to process the transaction, but provided no explanation.";try{n=z.labelOverride.transactionError.error.unknown||n}catch(e){}try{n+=" <span class='hint'>(HTML status: "+(e.status||"[No Status]")+" "+(e.statusText||"[No Text]")+")</span>"}catch(e){window.console&&console.log("Caught error: ",e.message)}}Y(n)}),!0)}function C(){var e={minimumGiftAmount:z.currentGiftMinimum};if("monthly"!=window.mwdspace.userInputData.giftFrequency)z.options.giftStringSingle&&(e.giftStringList=S("single")||z.options.giftStringSingle);else if(z.options.giftStringMonthly){var n=S("monthly");n?e.giftStringList=n:(n=S("single"),n?(e.calculateAsMonthly=!0,e.giftStringList=n):e.giftStringList=z.options.giftStringMonthly)}var t=window.mwdspace.giftUtils.processGiftStringList(e);E(t),u()}function S(e){if("undefined"==typeof e)var e="";var n="giftStringSingle";"monthly"==e&&(n="giftStringMonthly");try{var t=z.options.filterListCurrency[window.mwdspace.userInputData.giftCurrency][n];if(t&&0<t.length)return t}catch(e){window.console&&console.warn("getCurrencySpecificGiftString() caught error: ",e.name,e.message)}return!1}function E(e){if("undefined"==typeof e)var e=[];try{if(!e||1>e.length)throw new Error("Invalid gift string list given");var n=Q.find("div.fixedAmountContainer");if(1!==n.length)throw new Error("Unable to identify the fixed gift amount container");n.empty();for(var t,o,a,r=null,d=0;d<e.length;d++)o=e[d],a=window.mwdspace.sharedUtils.makeUniqueId("amount-"+d),!r&&(o+"").match(/\*/)&&(r=a),t=A(o,{id:a}),t?n.append(t):window.console&&console.warn("Unable to add fixed gift button:",o);r?n.find("div.giftAmountContainer input#"+r).prop("checked",!0).trigger("change"):n.find("div.giftAmountContainer input[name='giftAmountFixed']").eq(1).prop("checked",!0).trigger("change")}catch(e){window.console&&console.error("Unable to build the fixed gift buttons",e)}}function A(e,n){if("undefined"==typeof n)var n={};"object"!=typeof n&&(n={},window.console&&console.warn("buildGiftStringButton(): ignoring invalid option object",n));var t=null;try{var o={amount:M(e),displayText:x(e)};if(!o.amount||!o.displayText)throw new Error("Invalid gift string amount");t=document.createElement("div"),K(t).addClass("giftOption fixed fancyRadioButton");var i=document.createElement("input");i.setAttribute("type","radio"),i.setAttribute("name","giftAmountFixed"),i.setAttribute("value",o.amount),n.id&&i.setAttribute("id",n.id),t.appendChild(i);var a=document.createElement("label");n.id&&a.setAttribute("for",n.id),t.appendChild(a);var r=document.createElement("span");K(r).addClass("currencySymbol"),a.appendChild(r);var d=document.createElement("span");K(d).addClass("displayAmount"),d.innerHTML=o.displayText||"Unknown",a.appendChild(d)}catch(n){window.console&&console.error("Error building the button for fixed amount:",e,n)}return t}function M(e){if("undefined"==typeof e){window.console&&console.warn("cleanCurrency() given empty input");var e=""}e=""+e;var n=parseFloat(e.replace(/[^0-9|\.]/g,""));return isNaN(n)?0:Math.round(100*n)/100}function x(e){if("undefined"==typeof e)var e="";e=""+e;var n=M(e);return n=n.toFixed(2),n=n.replace(/\.00$/g,""),n}function F(e){var n=null;try{e.code&&(n=document.createElement("option"),n.setAttribute("value",e.code),n.innerText=e.code+" "+(e.name||""))}catch(n){window.console&&console.error("Unable to build the option element for currency:",e)}return n}function I(e){var n=null;try{e.code&&(n=document.createElement("option"),n.setAttribute("value",e.code),n.setAttribute("data-label-id","gift.payMethod."+e.code),n.innerText=e.description||"Unknown")}catch(n){window.console&&console.error("Unable to build the option element for method:",e)}return n}function L(e,n){if("undefined"==typeof n)var n={};"object"!=typeof n&&(n={},window.console&&console.warn("buildFrequencyButton(): ignoring invalid option object",n));var t=null;try{if(e.code){t=document.createElement("div"),K(t).addClass("fancyRadioButton");var o=document.createElement("input");K(o).addClass("changeWatch"),o.setAttribute("type","radio"),o.setAttribute("name","giftFrequency"),o.setAttribute("value",e.code),n.id&&o.setAttribute("id",n.id),t.appendChild(o);var i=document.createElement("label");i.setAttribute("data-label-id","gift.frequency."+e.code),i.innerHTML=e.name||"Unknown",n.id&&i.setAttribute("for",n.id),t.appendChild(i)}}catch(n){window.console&&console.error("Error building the button for frequency:",e,n)}return t}function O(){if("undefined"==typeof e)var e={};"object"!=typeof e&&(e={},window.console&&console.warn("prepareRegionInput(): ignoring invalid option object",e));try{for(var n,t=Q.find("select[name=\"donorCountry\"]").val(),o=0;o<window.mwdspace.validCountryList.length;o++)if(n=window.mwdspace.validCountryList[o],(t==n.code||t==n.name)&&n.regions&&k(n.regions))return}catch(e){window.console&&console.error("Unable to prepare the region input method",e)}P()}function P(){oe.hide(),ie.val("").show().trigger("change")}function k(e){if(ie.hide(),oe.val("").show().trigger("change"),"undefined"==typeof e)return window.console&&console.warn("buildRegionSelect(): no regions object",e),!1;if("object"!=typeof e||1>e.length)return window.console&&console.warn("buildRegionSelect(): invalid regions object",e),!1;try{if(1!==oe.length)return window.console&&console.error("Unable to identify the region select dropdown"),!1;var n,t,o=0;oe.empty(),n=T("State/Region...",{"data-label-id":"donor.regionPlaceholder",value:""}),oe.append(n);for(var a=0;a<e.length;a++)t=e[a],n=T(t.name),n?(oe.append(n),o++):window.console&&console.warn("Unable to add region:",t);if(0<o)return!0}catch(e){window.console&&console.error("Unable to build the region select dropdown",e)}return!1}function T(e,n){if("undefined"==typeof n)var n={};"object"!=typeof n&&(window.console&&console.warn("buildRegionOption() ignoring invalid attributes object",n),n={});try{if("string"==typeof e&&e.trim()){var t=null;for(var o in t=document.createElement("option"),t.innerText=e,n)t.setAttribute(o,n[o]);return t}}catch(e){window.console&&console.error("Unable to build the option element for region:",region)}return null}function j(e,n){if("undefined"==typeof n)var n={};"object"!=typeof n&&(window.console&&console.warn("buildCountryOption() ignoring invalid attributes object",n),n={});var t=null;try{e.code&&(t=document.createElement("option"),t.innerText=e.name)}catch(n){window.console&&console.error("Unable to build the option element for country:",e)}for(var o in n)t.setAttribute(o,n[o]);return t}function U(e,n){if("undefined"==typeof n)var n={};"object"!=typeof n&&(window.console&&console.warn("buildRegionOption() ignoring invalid attributes object",n),n={});var t=null;try{if("number"!=typeof e&&"string"!=typeof e&&!e)window.console&&console.error("Invalid month given:",e);else{try{var o=parseInt(e);!isNaN(o)&&0<=o&&10>o&&(e="0"+o)}catch(e){}for(var i in t=document.createElement("option"),n)t.setAttribute(i,n[i]);t.innerText=e}}catch(n){window.console&&console.error("Unable to build the option element for month:",e)}return t}function q(e,n){if("undefined"==typeof n)var n={};"object"!=typeof n&&(window.console&&console.warn("buildRegionOption() ignoring invalid attributes object",n),n={});var t=null;try{if("number"!=typeof e&&"string"!=typeof e&&!e)window.console&&console.error("Invalid year given:",e);else{if("undefined"==typeof e);for(var o in t=document.createElement("option"),n)t.setAttribute(o,n[o]);t.innerText=e}}catch(n){window.console&&console.error("Unable to build the option element for year:",e)}return t}function N(){Spreedly.setFieldType("number","text"),Spreedly.setNumberFormat("prettyFormat");var e=te.css("font-size")||"16px",n=te.css("color")||"#333",t="padding:0;font-size:"+e+";color:"+n+";";Spreedly.setStyle("number",t),Spreedly.setStyle("cvv",t);var o="Card",i="cvv";try{z.labelOverride.cardInfo.cardNumberPlaceholder&&(o=z.labelOverride.cardInfo.cardNumberPlaceholder)}catch(e){}try{z.labelOverride.cardInfo.cvvPlaceholder&&(i=z.labelOverride.cardInfo.cvvPlaceholder)}catch(e){}Spreedly.setPlaceholder("number",o),Spreedly.setPlaceholder("cvv",i)}function _(e,n){e?re.find("span.cardNumberValidity").removeClass("invalid").addClass("valid").html("<i class=\"fa fas fa-check-circle\"></i>"):re.find("span.cardNumberValidity").removeClass("valid").addClass("invalid").html("<i class=\"fa fas fa-times\"></i>");var t=re.find("span.cardType");"visa"===n?t.html(z.payMethodIconHtml.visa).addClass("known"):"master"===n?t.html(z.payMethodIconHtml.mastercard).addClass("known"):"american_express"===n?t.html(z.payMethodIconHtml.amex).addClass("known"):"discover"===n?t.html(z.payMethodIconHtml.discover).addClass("known"):t.html(z.payMethodIconHtml.card).removeClass("known")}function D(){if(J.hasValidCardNumber&&J.hasValidCardCvv&&J.payCardExpireMonth&&J.donorFirstName&&J.donorLastName&&J.payCardExpireYear){if("object"==typeof Spreedly){var e={first_name:J.donorFirstName,last_name:J.donorLastName,month:J.payCardExpireMonth,year:J.payCardExpireYear};return J.donorEmail&&(e.email=J.donorEmail),J.donorPhone&&(e.phone_number=J.donorPhone),J.donorStreet&&(e.address1=J.donorStreet),J.donorCity&&(e.city=J.donorCity),J.donorRegion&&(e.state=J.donorRegion),J.donorPostCode&&(e.zip=J.donorPostCode),J.donorCountry&&(e.country=J.donorCountry),Spreedly.tokenizeCreditCard(e),!0}window.console&&console.error("NO SPREEDLY OBJECT")}else window.console&&console.error("SPREEDLY FIELD NOT READY");return!1}function R(){var e="";if("bitcoin"==window.mwdspace.userInputData.payMethod)e=z.payMethodIconHtml.bitcoin;else if("card"==window.mwdspace.userInputData.payMethod)switch(window.mwdspace.userInputData.payCardType){case"visa":e=z.payMethodIconHtml.visa;break;case"mastercard":case"master":case"mc":e=z.payMethodIconHtml.mastercard;break;case"amex":case"american_express":case"americanexpress":e=z.payMethodIconHtml.amex;break;case"discover":case"disc":e=z.payMethodIconHtml.discover;}var n=Q.find("section[data-step-name=\"processing\"]");n.find("span.processingPaySymbol").html(e),t("processing")}function V(e){if("object"!=typeof e)return window.console&&console.warn("prepAndShowBitcoinStep() given invalid input",e),void Y("Unable to display Bitcoin invoice screen");var n=Q.find("section[data-step-name=\"bitcoinInvoice\"]");n.find("span.bitcoinStatus").html(e.invoice_status),n.find("img.scanCode").attr("src","data:image/png;charset=utf-8;base64,"+e.img_data),n.find("span.bitcoinAmount").html(e.alt_amount),n.find("span.bitcoinWalletLink").html(e.checkout_url),n.find("a.bitcoinWalletLink").attr("href",e.checkout_url),W(e.exp),z.intervals.bitcoinTimer=setInterval(function(){W(e.exp)},1e3),t("bitcoinInvoice"),z.intervals.bitcoinStatusChecker=setInterval(function(){window.console&&console.log("Calling checkBitcoinPaymentStatus() with ",e.transaction_id),H(e.transaction_id)},3e4)}function W(e){if("undefined"==typeof e)var e=null;var n="Unknown time";try{var t=0,o=0,i=new Date(e).getTime(),a=new Date().getTime(),r=(i-a)/1e3/60;0<r?(t=parseInt(r),o=parseInt(60*(r-t)),2>r&&de.closest("div.bitcoinStatusDisplay").addClass("warning")):(de.closest("div.bitcoinStatusDisplay").addClass("error"),clearInterval(z.intervals.bitcoinTimer)),10>o&&(o="0"+o),n=t.toFixed()+":"+o}catch(e){window.console&&console.warn("updateBitcoinTimer() caught error",e.message)}de.html(n)}async function H(e){"string"!=typeof e&&(window.console&&console.warn("checkBitcoinPaymentStatus() given invalid transaction id:",typeof e,e),resolve(null));var n=z.urls.bitcoinPaymentApi;se&&(n=z.urls.testBitcoinPaymentApi);var t=Q.find("div.bitcoinContainer"),o=await new Promise(function(t){var o=encodeURI(n+"invoices/"+e),i=new XMLHttpRequest;i.addEventListener("load",function(e){var n=e.target.responseText||e.target.response||null,o=window.mwdspace.sharedUtils.safeJsonParse(n);o&&o.data||(window.console&&console.log("checkBitcoinPaymentStatus(): invalid response",e),t(null)),t(o.data)}),i.addEventListener("error",function(e){window.console&&console.error("checkBitcoinPaymentStatus() ERROR EVENT",o,e),t(null)}),i.open("get",o,!0),i.setRequestHeader("Accept","application/json"),i.send()});if(!o){var i=document.createElement("div");return i.innerHTML="Warning: Unable to verify the status of this invoice ("+new Date().toLocaleTimeString()+"). Will try again shortly.</div>",K(i).addClass("spacingContainer error"),void t.find("div.bitcoinFeedback").empty().append(i)}switch(window.console&&console.log("checkBitcoinPaymentStatus() RESPONSE",o),t.find("div.bitcoinStatus").html(o.status),o.status){case"paid":case"confirmed":case"complete":B(),clearInterval(z.intervals.bitcoinStatusChecker);break;case"expired":Y("The Bitcoin invoice expired before payment was received."),clearInterval(z.intervals.bitcoinStatusChecker);break;case"invalid":var i=document.createElement("div");i.innerHTML="The invoice received payments, but is listed as invalid.",K(i).addClass("spacingContainer error"),t.find("div.bitcoinFeedback").empty().append(i);break;case"new":se&&(B(),clearInterval(z.intervals.bitcoinStatusChecker));}}function B(e){if("undefined"==typeof e)var e={};var n=Q.find("section[data-step-name=\"confirmation\"] span.confirmationMessage"),o="Thank you";try{z.labelOverride.confirmation.thankYouText&&(o=z.labelOverride.confirmation.thankYouText)}catch(e){}n.html(o);try{if(window.mwdspace.userInputData.donorFirstName){var i=document.createElement("strong");i.innerHTML=window.mwdspace.userInputData.donorFirstName,n.append(", "),n.append(i)}}catch(e){}if(n.append("!"),t("confirmation"),z.options.onDonation)try{window.console&&console.log(">>> Calling custom onDonation function"),z.options.onDonation(window.mwdspace.userInputData)}catch(e){window.console&&console.error("Caught error from onDonation function: ",e.message)}}function Y(e){if("undefined"==typeof e)var e={};var n=Q.find("section[data-step-name=\"transactionError\"]");n.find("span.errorMessage").html(e),t("transactionError")}function G(e){function n(e,n){if("undefined"==typeof n)var n=0;K("html,body").animate({scrollTop:e+n},555)}if("undefined"!=typeof e&&z.allowAutoScroll&&(e=K(e),!(0>=e.length))){var t=K(window).scrollTop(),o=K(window).height(),i=t,a=e.innerHeight(),r=(e.outerHeight()-a)/2;r=0>=r?0:r;var d=e.offset().top,s=d+a,l=0;if("string"==typeof z.defaults.topVisualPaddingSelector&&(l=K(z.defaults.topVisualPaddingSelector).outerHeight()||0,l=l>.25*o?.25*o:l),a>o||i+l>d)return void n(d-l,-5);if(i+o<s){var c=s-o;c<l&&(c=l),n(c,5)}}}var z=this;"function"!=typeof z.jquery&&(window.console&&console.error("jQuery (thisWidget.jquery) not found"),exit());var K=z.jquery;window.mwdspace.userInputData={},window.mwdspace.transactionSendData={};var J=window.mwdspace.userInputData;z.currentGiftMinimum=z.defaults.minimumGiftAmount,window.mwdspace.pageIdPrefix="widget"+z.options.formId;var Q=K("div.giftFormContainer"),X=Q.find("section.step"),Z=Q.find("div.giftFormHeaderContainer"),ee=Q.find("button.goPreviousStep"),ne=Q.find("input[name=\"giftAmountFreeform\"]"),te=Q.find("select[name=\"payMethod\"]"),oe=Q.find("select[name=\"donorRegion\"]"),ie=Q.find("input[name=\"donorRegion\"]"),ae=Q.find("select[name=\"giftCurrency\"]"),re=Q.find("div.payInfoContainer div.cardNumberFeedback"),de=Q.find("div.bitcoinContainer span.bitcoinTimeRemaining"),se="true"==window.mwdspace.sharedUtils.getUrlParameter("test");se&&(window.console&&console.warn("TEST MODE - mwd-donate-widget.js"),Q.find("div.testModeContainer").slideDown(999)),z.promises.labelOverrideLoad=z.prepareLabelOverride(),function(){var e=Q.find("input[name=\"companyMatch\"]").closest("div.inputGroup");z.options.includeCompanyMatch?e.show():e.hide();var n=Q.find("input[name=\"giftExtraPercent\"]").closest("div.inputGroup");z.options.includeExtraPercent?n.show():n.hide()}(),function(e){if("undefined"==typeof e)var e={};"object"!=typeof e&&(e={},window.console&&console.warn("buildCountrySelect(): ignoring invalid option object",e));var n="string"==typeof e.default?e.default:"United States";try{if(!window.mwdspace.validCountryList)throw new Error("List of valid countries not found");var t=Q.find("select[name=\"donorCountry\"]");if(t.on("change",O),1!==t.length)throw new Error("Unable to identify the country select dropdown");for(var o,a,r,d=0;d<window.mwdspace.validCountryList.length;d++)r=!0,a=window.mwdspace.validCountryList[d],r&&(o=j(a),o?t.append(o):window.console&&console.warn("Unable to add country:",a));t.val(n).trigger("change")}catch(e){window.console&&console.error("Unable to build the country select dropdown",e)}}(),function(){try{var e=Q.find("select[name=\"payCardExpireMonth\"]");if(1!==e.length)throw new Error("Unable to identify the card expire month select dropdown");var n=U("Month",{value:"","data-label-id":"cardInfo.cardExpireMonthPlaceholder"});e.append(n);for(var t=1;12>=t;t++)n=U(t),n?e.append(n):window.console&&console.warn("Unable to add card expire month:",t)}catch(e){window.console&&console.error("Unable to build the card expire month select dropdown",e)}}(),function(){try{var e=new Date;e.setDate(e.getDate()-7);var n=e.getFullYear(),t=Q.find("select[name=\"payCardExpireYear\"]");if(1!==t.length)throw new Error("Unable to identify the card expire year select dropdown");var o=q("Year",{value:"","data-label-id":"cardInfo.cardExpireYearPlaceholder"});t.append(o);for(var i=n;i<n+20;i++)o=q(i),o?t.append(o):window.console&&console.warn("Unable to add card expire year:",i)}catch(e){window.console&&console.error("Unable to build the card expire year select dropdown",e)}}(),async function(){z.promises.spreedlyIframeScript&&(await z.promises.spreedlyIframeScript);var e="Search by company name";try{z.labelOverride.donor.matchCompanyPlaceholder&&(e=z.labelOverride.donor.matchCompanyPlaceholder||e)}catch(e){}var n=K("select[name=\"donorMatchCompany\"]");return"function"==typeof n.select2?void n.select2({minimumInputLength:3,delay:400,placeholder:e,width:"100%",ajax:{url:z.urls.companyMatchApi,data:function(e){var n={q:e.term};return n},processResults:function(e){var n={results:[]};if("object"==typeof e&&e.length)for(var t=0;t<e.length;t++)e[t].name&&n.results.push({id:e[t].name,text:e[t].name});return n}}}):void(window.console&&console.warn("SKIPPING COMPANY MATCH SMART SELECTOR"))}(),function(){K(document).on("change blur",function(e){var n=K(e.target),t=n.attr("name"),o=n.val(),i=(n.prop("tagName")+"").toLowerCase();if(n.hasClass("changeWatch")&&d(n,{name:t,value:o}),("giftAmountFixed"==t||"giftAmountFreeform"==t)&&"input"==i)l(e);else if("giftExtraPercent"==t&&"input"==i){var a=0;n.prop("checked")&&(a=n.val()),c({extraPercent:a})}else"giftCurrency"==t&&"select"==i?(u(),C()):"payMethod"==t&&"select"==i?p():"giftFrequency"==t&&"input"==i&&f(o)}),Q.find("div.giftOption input[name=\"giftAmountFreeform\"]").on("focus keyup paste",function(e){l(e)}),Q.find("input#inputCompanyMatch").on("change",function(){K(this).prop("checked")?Q.find("div#collapsableCompanyMatch").slideDown(666,function(){G(Q)}):Q.find("div#collapsableCompanyMatch").slideUp(333,function(){G(Q)})}).trigger("change")}(),function(){try{if(!window.mwdspace.validPayMethodList)throw new Error("List of valid payment methods not found");if(1!==te.length)throw new Error("Unable to identify the payment method select dropdown");for(var e,n,t,o=null,a=0,r=0;r<window.mwdspace.validPayMethodList.length;r++)n=window.mwdspace.validPayMethodList[r],t=!0,z.options.filterListPayMethod&&0>z.options.filterListPayMethod.indexOf(n.code)&&(t=!1),t&&(e=I(window.mwdspace.validPayMethodList[r]),e?(te.append(e),a++):window.console&&console.warn("Unable to add payment method:",window.mwdspace.validPayMethodList[r]),(z.options.defaultPayMethod===n.code||!o)&&(o=n.code));te.val(o).trigger("change"),1===a?te.closest("div.inputGroup").hide():te.closest("div.inputGroup").show()}catch(e){window.console&&console.error("Unable to build the payment method select dropdown",e)}}(),await z.promises.labelOverrideLoad,z.labelOverride&&(z.processLabelOverrideObject(z.labelOverride),function(){var e=Z.find("div.introContentContainer");""!=e.html()&&(Z.find("div.giftFormHeader").addClass("showIntro"),Z.show())}()),function(){var e=z.options.filterListCurrency,n="string"==typeof z.options.defaultCurrency?z.options.defaultCurrency:z.defaults.currencyCode,t=0;try{if(!window.mwdspace.validCurrencyList)throw new Error("List of valid currencies not found");if(1!==ae.length)throw new Error("Unable to identify the currency select dropdown");for(var o,a,r,d=0;d<window.mwdspace.validCurrencyList.length;d++)r=!0,a=window.mwdspace.validCurrencyList[d],e&&(r="object"==typeof e[a.code]),r&&(o=F(a),o?(ae.append(o),t++):window.console&&console.warn("Unable to add currency:",a));ae.val(n).trigger("change"),1==t?ae.hide():ae.show()}catch(e){window.console&&console.error("Unable to build the currency select dropdown",e)}}(),function(){try{if(!window.mwdspace.validFrequencyList)throw new Error("Invalid list of frequencies given");var e=Q.find("div.giftFrequencyContainer");if(1!==e.length)throw new Error("Unable to identify the frequency container");e.find("div.fancyRadioButton").remove();for(var n,t,o,a=[],r=0,d=0,s=0;s<window.mwdspace.validFrequencyList.length;s++)t=window.mwdspace.validFrequencyList[s],o=!0,z.options.filterListFrequency&&0>z.options.filterListFrequency.indexOf(t.code)&&(o=!1),o&&(n=L(t,{id:window.mwdspace.sharedUtils.makeUniqueId("frequency-"+s)}),n?(e.append(n),a.push(t.code)):window.console&&console.warn("Unable to add frequency:",t),z.options.defaultFrequency===t.code&&(r=d),d++);e.find("input[name=\"giftFrequency\"]").eq(r).prop("checked",!0).trigger("change"),m(a)}catch(e){window.console&&console.error("Unable to build the frequency buttons",e)}}(),c(),function(){g("first","donorFirstName"),g("last","donorLastName"),g("email","donorEmail"),g("phone","donorPhone"),g("street","donorStreet"),g("city","donorCity"),g("postcode","donorPostCode"),g("country","donorCountry"),g("region","donorRegion"),h("currency","giftCurrency"),h("amount","giftAmountFreeform")}(),t();var le=function(){return new Promise(async e=>{await z.promises.spreedlyIframeScript,Spreedly.on("ready",function(){N(),e()}),Spreedly.on("paymentMethod",function(e,n){if(window.mwdspace.transactionSendData.paymentToken=null,n.errors&&0<n.errors.length){window.console&&console.warn("SPREEDLY REPORTS paymentMethod ERRORS:");for(var t,o=0;o<n.errors.length;o++)t=n.errors[o],window.console&&console.warn(t);var a="Error during secure card information transfer. Please try again.";try{a=z.labelOverride.gift.error.tokenizeError||a}catch(e){}r("cardInfo",a,!0)}else window.mwdspace.transactionSendData.paymentToken=e,w(),r("cardInfo")}),Spreedly.on("fieldEvent",function(e,n,t,o){"input"==n&&(window.mwdspace.userInputData.hasValidCardNumber=o.validNumber||!1,window.mwdspace.userInputData.hasValidCardCvv=o.validCvv||!1,window.mwdspace.userInputData.payCardType=o.cardType||!1,"number"==e&&_(o.validNumber,o.cardType))}),Spreedly.on("errors",function(e){window.console&&console.warn("SPREEDLY REPORTS GENERAL ERRORS:");for(var n,t=0;t<e.length;t++)n=e[t],window.console&&console.warn(n);var o="Unexpected error with secure card handler";try{o=z.labelOverride.gift.error.generalTokenizerError||o}catch(e){}r("cardInfo",o,!0)});var n=z.options.paymentTokenApiKey;se&&(n=z.defaults.testPaymentTokenApiKey),Spreedly.init(n,{numberEl:"cardNumberTarget",cvvEl:"cardCvvTarget"})})}();if(document.addEventListener("click",function(o){var i=K(o.target).closest("button, .clickTarget");i&&(i.hasClass("goNextStep")?!e()&&(i.addClass("showInvalid"),setTimeout(function(){i.removeClass("showInvalid")},1500)):i.hasClass("goPreviousStep")?n():i.hasClass("errorRestart")?(window.mwdspace.donationInProgress=!1,t("giftAmount")):i.hasClass("infoIcon")&&i.trigger("hover"))}),setTimeout(function(){z.allowAutoScroll=!0},999),await le,z.isLoaded=!0,z.options.onLoad)try{window.console&&console.log(">>> Calling custom onLoad function"),z.options.onLoad()}catch(e){window.console&&console.error("Caught error from onLoad function: ",e.message)}},window.mwdspace.MFA_Funraise_Widget.prototype.linkExternalStylesheet=function(e){var n=this;return new Promise(function(t){var o=document.createElement("link");n.domTargetElement.appendChild(o),o.rel="stylesheet",o.type="text/css";var i=setTimeout(function(){window.console&&console.log("linkExternalStylesheet() No load after 5s",e),t(!1)},5e3);o.addEventListener("load",function(){clearTimeout(i),t(!0)}),o.addEventListener("error",function(n){window.console&&console.error("linkExternalStylesheet() ERROR EVENT",e,n),t(!1)}),o.href=encodeURI(e)})},window.mwdspace.MFA_Funraise_Widget.prototype.linkExternalScript=function(e){var n=this;return new Promise(function(t){var o=document.createElement("script");n.domTargetElement.appendChild(o);var i=setTimeout(function(){window.console&&console.log("linkExternalScript() No load after 5s",e),t(!1)},5e3);o.addEventListener("load",function(){clearTimeout(i),t(!0)}),o.addEventListener("error",function(n){clearTimeout(i),window.console&&console.error("linkExternalScript() ERROR",e,n),t(!1)}),o.src=encodeURI(e)})},window.mwdspace.MFA_Funraise_Widget.prototype.loadFile=function(e){this;return new Promise(function(n){"undefined"==typeof e&&(window.console&&console.warn("loadFile() given empty url"),n(null)),"string"!=typeof e&&(window.console&&console.warn("loadFile() given invalid url type:",typeof e,e),n(null));var t=encodeURI(e),o=new XMLHttpRequest,i=setTimeout(function(){window.console&&console.log("linkExternalScript() No load after 5s",url),n(!1)},5e3);o.addEventListener("load",function(e){clearTimeout(i);var t=e.target.responseText||e.target.response||null;n(t)}),o.addEventListener("error",function(e){clearTimeout(i),window.console&&console.error("loadFile() ERROR EVENT",t,e),n(null)}),o.open("get",t,!0),o.send()})},window.mwdspace.MFA_Funraise_Widget.prototype.getFontIconStyles=function(){var e=this;return new Promise(async n=>{var t=!1;return 4==e.options.fontAwesomeVersion?t=await e.linkExternalStylesheet(e.urls.fontAwesome4):5==e.options.fontAwesomeVersion&&(t=await e.linkExternalStylesheet(e.urls.fontAwesome5)),n(t)})},window.mwdspace.MFA_Funraise_Widget.prototype.prepareLabelOverride=function(){var e=this;return new Promise(async n=>{if(e.options.labelOverrideObject)window.console&&console.log("Using label object"),e.labelOverride=e.options.labelOverrideObject,n(!0);else if(e.options.labelOverrideFileUrl)try{window.console&&console.log("Loading label file:",e.options.labelOverrideFileUrl);var t=await e.loadFile(e.options.labelOverrideFileUrl);if(t){var o=window.mwdspace.sharedUtils.safeJsonParse(t);o?(e.labelOverride=o,n(!0)):window.console&&console.error("MFA_Funraise_Widget.prepareLabelOverride() - unable to parse text override data from file:",e.options.labelOverride)}else window.console&&console.error("MFA_Funraise_Widget.prepareLabelOverride() - unable to load file for text override data:",e.options.labelOverride)}catch(e){window.console&&console.log("prepareLabelOverride() caught error: ",e.message)}n(!1)})},window.mwdspace.MFA_Funraise_Widget.prototype.processLabelOverrideObject=function(e,n){var t=this;if("object"!=typeof e||!e)return window.console&&console.warn("MFA_Funraise_Widget.processLabelOverrideObject() given invalid object",typeof e),!1;if("undefined"==typeof n)var n="";"string"!=typeof n&&(window.console&&console.warn("Ignoring invalid string prefix value",n),n=""),n&&(n+=".");var o;for(var i in e)o=n+i,"string"==typeof e[i]?t.setElementLabelOverride(o,e[i]):t.processLabelOverrideObject(e[i],o)},window.mwdspace.MFA_Funraise_Widget.prototype.setElementLabelOverride=function(e,n){this;if("undefined"==typeof e)var e="";if(!e)return void(window.console&&console.warn("setElementLabelOverride() given empty labelId"));var t,o="[data-label-id=\""+e+"\"]",a=document.querySelectorAll(o);if(a)for(var r=0;r<a.length;r++)t=(a[r].tagName+"").toLowerCase(),"input"===t?a[r].setAttribute("placeholder",n):"label"===t||"span"===t||"div"===t||"option"===t||"h1"===t||"h2"===t||"h3"===t||"h4"===t||"h5"===t||"h6"===t||"p"===t||"li"===t?a[r].innerHTML=n:window.console&&console.warn("setElementLabelOverride(): Ignoring tag",e,t);else window.console&&console.warn("REPLACE labelId not found",e)}})();