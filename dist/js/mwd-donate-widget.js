"use strict";(function(){console.log("mwd-donate-widget.js v18.7.8a"),window.mwdspace=window.mwdspace||{};var a={card:"<i class=\"far fa-credit-card\"></i>",visa:"<i class=\"fab fa-cc-visa\"></i>",mastercard:"<i class=\"fab fa-cc-mastercard\"></i>",amex:"<i class=\"fab fa-cc-amex\"></i>",discover:"<i class=\"fab fa-cc-discover\"></i>",bitcoin:"<i class=\"fab fa-bitcoin\"></i>"};window.mwdspace.MFA_Funraise_Widget=function(a){var b=this;if(b.options="object"==typeof a?a:{},b.isStarted=!1,b.isLoaded=!1,b.codeVersion="1.0.0",b.targetElement={},b.promises={},b.intervals={},b.mainStylesUrl=window.location.protocol+"//services.mwdagency.com/donate-widget/1.0.0/css/mwd-donate-widget.css",b.mainHtmlUrl=window.location.protocol+"//services.mwdagency.com/donate-widget/1.0.0/mwd-donate-widget.html",console.log("window.mwdspace.MFA_Funraise_Widget",b.codeVersion),b.options.loadingText||(b.options.loadingText="One moment..."),!b.options.element)return console.warn("Invalid options - No target element:",b.options),!1;"string"==typeof b.options.organizationId&&b.options.organizationId.trim()||(b.options.organizationId="fcb4d538-ca92-4212-86cc-06d8ac929c4d"),(!b.options.formId||isNaN(b.options.formId))&&(b.options.formId=4394),b.options.listSingleGiftAskString&&b.options.listSingleGiftAskString.length||(b.options.listSingleGiftAskString=[25,"50*",75,100]),b.options.listMonthlyGiftAskString&&b.options.listMonthlyGiftAskString.length||(b.options.listMonthlyGiftAskString=[5,10,"15*",20]);var c=document.querySelectorAll(b.options.element);return c?void(b.targetElement=c[0]):(console.warn("Specified target element not found:",b.options.element),!1)},window.mwdspace.MFA_Funraise_Widget.prototype.start=async function(){var a=this;if(a.isStarted)return void console.warn("window.mwdspace.MFA_Funraise_Widget already started");a.isStarted=!0,a.targetElement.innerHTML="";var b=a.linkExternalStylesheet("https://use.fontawesome.com/releases/v5.1.0/css/all.css"),c=a.options.styleSheets||a.mainStylesUrl,d=a.linkExternalStylesheet(c);a.linkExternalStylesheet("https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css"),await Promise.all([b,d]);var e,f,g=a.loadFile(a.mainHtmlUrl),h=a.linkExternalScript(window.location.protocol+"//services.mwdagency.com/donate-widget/1.0.0/js/shared-utils.js");if([e,f]=await Promise.all([g,h]),!e)return void console.error("MFA_Funraise_Widget.start() - unable to load base HTML");var i=document.createElement("div");i.id="mfaDonationWidgetContainer",i.style.opacity=0,a.targetElement.appendChild(i),i.innerHTML=e,setTimeout(function(){i.className="reveal"},1),a.promises.spreedlyIframeScript=a.linkExternalScript("https://core.spreedly.com/iframe/iframe-v1.min.js");var j=await a.linkExternalScript("https://code.jquery.com/jquery-3.3.1.min.js"),k=a.linkExternalScript("https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.min.js"),l=a.linkExternalScript(window.location.protocol+"//services.mwdagency.com/donate-widget/1.0.0/js/gift-utilities.js"),m=a.linkExternalScript(window.location.protocol+"//services.mwdagency.com/donate-widget/1.0.0/js/transaction-system-layer.js");await Promise.all([l,m,k]),a.jquery=j?jQuery.noConflict():$||{},a.run()},window.mwdspace.MFA_Funraise_Widget.prototype.run=async function(){function b(){switch(mwdspace.currentStepName){case"giftAmount":if(e())return d("donorInfo"),!0;break;case"donorInfo":if(f())return d("payment"),!0;break;case"payment":if(g())return alert("Would process donation"),!0;}return!1}function c(){switch(mwdspace.currentStepName){case"donorInfo":d("giftAmount");break;case"payment":d("donorInfo");}}function d(a){mwdspace.currentStepName="",a=window.mwdspace.sharedUtils.ensureString(a),a||(a=window.mwdspace.sharedUtils.getSessionValue("savedStepName"),!a&&(a="giftAmount")),T.find("div.loadingDisplay").hide();for(var b,c=0;c<U.length;c++)b=U[c].getAttribute("data-step-name"),b==a?(0==c||"confirmation"==a?V.hide():(Q("div.giftFormHeaderContainer").show(),V.fadeIn(888)),Q(U[c]).fadeIn(666,function(){O(T)}),mwdspace.currentStepName=b,"confirmation"==a&&window.mwdspace.sharedUtils.removeSessionValue("savedStepName")):Q(U[c]).hide()}function e(){var a=!0;return("number"!=typeof R.baseAmount||R.baseAmount<R.minimumAmount||1>R.baseAmount)&&(console.warn("baseAmount is invalid",R.baseAmount),a=!1),"string"!=typeof R.giftCurrency&&(console.warn("giftCurrency is invalid",R.giftCurrency),a=!1),"string"!=typeof R.payMethod&&(console.warn("payMethod is invalid",R.payMethod),a=!1),"string"!=typeof R.giftFrequency&&(console.warn("giftFrequency is invalid",R.giftFrequency),a=!1),a}function f(){var a=!0;return"string"!=typeof R.donorFirstname&&(console.warn("donorFirstname is invalid",R.donorFirstname),a=!1),"string"!=typeof R.donorLastname&&(console.warn("donorLastname is invalid",R.donorLastname),a=!1),"string"!=typeof R.donorEmail&&(console.warn("donorEmail is invalid",R.donorEmail),a=!1),"undefined"!=typeof R.donorPhone&&"string"!=typeof R.donorPhone&&(console.warn("donorPhone is invalid",R.donorPhone),a=!1),"string"!=typeof R.donorStreet&&(console.warn("donorStreet is invalid",R.donorStreet),a=!1),"string"!=typeof R.donorRegion&&(console.warn("donorRegion is invalid",R.donorRegion),a=!1),"string"!=typeof R.donorPostCode&&(console.warn("donorPostCode is invalid",R.donorPostCode),a=!1),"string"!=typeof R.donorCountry&&(console.warn("donorCountry is invalid",R.donorCountry),a=!1),"on"==R.companyMatch&&("string"!=typeof R.donorMatchCompany&&(console.warn("donorMatchCompany is invalid",R.donorMatchCompany),a=!1),"string"!=typeof R.donorMatchEmail&&(console.warn("donorMatchEmail is invalid",R.donorMatchEmail),a=!1)),a}function g(){return!1}function h(a,b){if("undefined"==typeof b)var b={};var c=!0,d=null;if(b.validationPattern=a.attr("data-validation"),b.validationPattern&&(c=i(a,b)),c){var e=a.attr("type");"checkbox"==e||"radio"==e?a.prop("checked")&&(d=b.value):d=b.value,a.hasClass("tokenizeWatch")&&G()}R[b.name]=d}function i(a,b){if("undefined"==typeof b)var b={};var c;switch(b.validationPattern){case"email":c=new RegExp(/^\w+@\w+\.[a-z]{2,}$/i);break;default:c=new RegExp(b.validationPattern,"i");}return b.value.match(c)?(a.removeClass("invalid"),!0):(a.addClass("invalid"),!1)}function j(a){Z.removeClass("selected");var b=Q(a.target);b.addClass("selected");var c=t(b.val())||0;k({baseAmount:c}),"change"==a.type&&Q("div.giftFormHeaderContainer").slideDown(666,function(){O(T)})}function k(a){if("undefined"==typeof a)var a={};try{R.baseAmount=parseFloat(a.baseAmount)||0,R.extraPercent=parseFloat(a.extraPercent)||0;var b=parseFloat(R.baseAmount+R.baseAmount*R.extraPercent),c=b.toFixed(2).split(".");T.find("div.amountDisplay span.displayWholeAmount").text(c[0]),T.find("div.amountDisplay span.displaySubAmount").text("."+c[1])}catch(a){console.log("updateGiftAmount() caught error: ",a.message)}}function l(){for(var a,b=_.val(),c=" (?) ",d=0;d<window.mwdspace.validCurrencyList.length;d++)if(a=window.mwdspace.validCurrencyList[d],a.code==b&&a.symbol){c=a.symbol;break}T.find("span.currencySymbol").html(c)}function m(){}function n(){q()}function o(){var a=window.mwdspace.userInputData,b={};try{if(b.organizationId=P.options.organizationId,b.formId=P.options.formId,a.organizationId&&(b.organizationId=a.organizationId),a.formId&&(b.formId=a.formId),a.paymentToken&&(b.paymentToken=a.paymentToken),a.firstName&&(b.firstName=a.donorFirstName),a.lastName&&(b.lastName=a.donorLastName),a.email&&(b.email=a.donorEmail),a.streetAddress&&(b.address=a.donorStreet),a.city&&(b.city=a.donorCity),a.region&&(b.state=a.donorRegion),a.postCode&&(b.postalCode=a.donorPostCode),a.country&&(b.country=a.donorCountry),"number"==typeof a.baseAmount){var c=a.baseAmount;"number"==typeof a.extraPercentage&&(c+=a.extraPercentage*a.baseAmount),b.amount=c,b.baseAmount=a.baseAmount}return a.currency&&(b.currency=a.giftCurrency),a.payMethod&&(b.paymentType=a.payMethod),"card"==a.payMethod&&(a.cardExpireMonth&&(b.month=a.cardExpireMonth),a.cardExpireYear&&(b.year=a.cardExpireYear),a.cardType&&(b.cardType=a.cardType),a.cardLastFour&&(b.lastFour=a.cardLastFour)),!0===a.isCompanyMatch&&(b.donateDouble=!0,a.companyMatchName&&(b.company=a.companyMatchName),a.companyMatchEmail&&(b.employeeEmail=a.companyMatchEmail)),b}catch(a){console.log("buildTransactionSendData() caught error: ",a.message)}return null}function p(a){a.addClass("blocked"),window.mwdspace.transactionLayer.startDonation(window.mwdspace.transactionSendData,function(b){if(console.log("SUCCESS FUNCTION",b),a.removeClass("blocked"),"card"==b.type){var c=b.status+"";c.match(/complete/i)?M():N("The server appears to have had an error processing this card transaction, and reported status \""+c+"\".")}else"bitcoin"==b.type?J(b):(console.warn("Unrecognized type property in server response",b),N("Unrecognized response from the sever"))},function(b){console.log("FAIL FUNCTION",b),a.removeClass("blocked"),console.warn("Donation received fail response from server",b),N("The server was unable to process the transaction")})}function q(){var a={};"monthly"==window.mwdspace.userInputData.frequency?P.options.listMonthlyGiftAskString&&(a.giftStringList=P.options.listMonthlyGiftAskString,!P.isMonthlyOnlyPage&&(a.calculateAsMonthly=!0)):P.options.listSingleGiftAskString&&(a.giftStringList=P.options.listSingleGiftAskString);var b=window.mwdspace.giftUtils.processGiftStringList(a);r(b)}function r(a){if("undefined"==typeof a)var a=[];try{if(!a||1>a.length)throw new Error("Invalid gift string list given");var b=T.find("div.fixedAmountContainer");if(1!==b.length)throw new Error("Unable to identify the fixed gift amount container");b.empty();for(var c,d=0;d<a.length;d++)c=s(a[d],{id:window.mwdspace.sharedUtils.makeUniqueId("amount-"+d)}),c?b.append(c):console.warn("Unable to add fixed gift button:",a[d])}catch(a){console.error("Unable to build the fixed gift buttons",a)}l()}function s(a,b){if("undefined"==typeof b)var b={};"object"!=typeof b&&(b={},console.warn("buildGiftStringButton(): ignoring invalid option object",b));var c=null;try{var d={amount:t(a),displayText:u(a)};if(!d.amount||!d.displayText)throw new Error("Invalid gift string amount");c=document.createElement("div"),Q(c).addClass("giftOption fixed fancyRadioButton");var e=document.createElement("input");e.setAttribute("type","radio"),e.setAttribute("name","giftAmountFixed"),e.setAttribute("value",d.amount),b.id&&e.setAttribute("id",b.id),c.appendChild(e);var f=document.createElement("label");b.id&&f.setAttribute("for",b.id),c.appendChild(f);var g=document.createElement("span");Q(g).addClass("currencySymbol"),f.appendChild(g);var h=document.createElement("span");Q(h).addClass("displayAmount"),h.innerHTML=d.displayText||"Unknown",f.appendChild(h)}catch(b){console.error("Error building the button for fixed amount:",a,b)}return c}function t(a){if("undefined"==typeof a)var a="";return a=""+a,parseFloat(a.replace(/[^0-9|\.]/g,""))}function u(a){if("undefined"==typeof a)var a="";a=""+a;var b=t(a);return b=b.toFixed(2),b=b.replace(/\.00$/g,""),b}function v(a){var b=null;try{a.code&&(b=document.createElement("option"),b.setAttribute("value",a.code),b.innerText=a.code+" "+(a.name||""))}catch(b){console.error("Unable to build the option element for currency:",a)}return b}function w(a){var b=null;try{a.code&&(b=document.createElement("option"),b.setAttribute("value",a.code),b.setAttribute("data-label-id","gift.payMethod."+a.code),b.innerText=a.description||"Unknown")}catch(b){console.error("Unable to build the option element for method:",a)}return b}function x(a,b){if("undefined"==typeof b)var b={};"object"!=typeof b&&(b={},console.warn("buildFrequencyButton(): ignoring invalid option object",b));var c=null;try{if(a.code){c=document.createElement("div"),Q(c).addClass("fancyRadioButton");var d=document.createElement("input");Q(d).addClass("changeWatch"),d.setAttribute("type","radio"),d.setAttribute("name","giftFrequency"),d.setAttribute("value",a.code),b.id&&d.setAttribute("id",b.id),c.appendChild(d);var e=document.createElement("label");e.setAttribute("data-label-id","gift.frequency."+a.code),e.innerHTML=a.name||"Unknown",b.id&&e.setAttribute("for",b.id),c.appendChild(e)}}catch(b){console.error("Error building the button for frequency:",a,b)}return c}function y(){if("undefined"==typeof a)var a={};"object"!=typeof a&&(a={},console.warn("prepareRegionInput(): ignoring invalid option object",a));try{for(var b,c=T.find("select[name=\"donorCountry\"]").val(),d=0;d<window.mwdspace.validCountryList.length;d++)if(b=window.mwdspace.validCountryList[d],(c==b.code||c==b.name)&&b.regions&&A(b.regions))return}catch(a){console.error("Unable to prepare the region input method",a)}z()}function z(){X.hide(),Y.val("").show().trigger("change")}function A(a){if(Y.hide(),X.val("").show().trigger("change"),"undefined"==typeof a)return console.warn("buildRegionSelect(): no regions object",a),!1;if("object"!=typeof a||1>a.length)return console.warn("buildRegionSelect(): invalid regions object",a),!1;try{if(1!==X.length)return console.error("Unable to identify the region select dropdown"),!1;var b,c,d=0;X.empty(),b=B("State/Region...",{"data-label-id":"donor.regionPlaceholder"}),X.append(b);for(var e=0;e<a.length;e++)c=a[e],b=B(c.name),b?(X.append(b),d++):console.warn("Unable to add region:",c);if(0<d)return!0}catch(a){console.error("Unable to build the region select dropdown",a)}return!1}function B(a,b){if("undefined"==typeof b)var b={};"object"!=typeof b&&(console.warn("buildRegionOption() ignoring invalid attributes object",b),b={});try{if("string"==typeof a&&a.trim()){var c=null;for(var d in c=document.createElement("option"),c.innerText=a,b)c.setAttribute(d,b[d]);return c}}catch(a){console.error("Unable to build the option element for region:",region)}return null}function C(a){var b=null;try{a.code&&(b=document.createElement("option"),b.innerText=a.name)}catch(b){console.error("Unable to build the option element for country:",a)}return b}function D(a,b){if("undefined"==typeof b)var b={};"object"!=typeof b&&(console.warn("buildRegionOption() ignoring invalid attributes object",b),b={});var c=null;try{if("number"!=typeof a&&"string"!=typeof a&&!a)console.error("Invalid month given:",a);else{if("undefined"==typeof d)var d=a;try{a=window.mwdspace.sharedUtils.ensureString(a),a=a.padStart(2,"0")}catch(a){}for(var e in c=document.createElement("option"),b)c.setAttribute(e,b[e]);c.innerText=a}}catch(b){console.error("Unable to build the option element for month:",a)}return c}function E(a,b){if("undefined"==typeof b)var b={};"object"!=typeof b&&(console.warn("buildRegionOption() ignoring invalid attributes object",b),b={});var c=null;try{if("number"!=typeof a&&"string"!=typeof a&&!a)console.error("Invalid year given:",a);else{if("undefined"==typeof a);for(var d in c=document.createElement("option"),b)c.setAttribute(d,b[d]);c.innerText=a}}catch(b){console.error("Unable to build the option element for year:",a)}return c}function F(){if("object"==typeof Spreedly){var a="Card",b="cvv";try{P.labelOverride.payment.cardNumberPlaceholder&&(a=P.labelOverride.payment.cardNumberPlaceholder)}catch(a){}try{P.labelOverride.payment.cvvPlaceholder&&(b=P.labelOverride.payment.cvvPlaceholder)}catch(a){}Spreedly.setPlaceholder("number",a),Spreedly.setPlaceholder("cvv",b),Spreedly.setStyle("number","font-size:16px;color:#333;"),Spreedly.setStyle("cvv","font-size:16px;color:#333;")}}function G(){if(!(R.donorFirstname&&R.donorLastname&&R.payCardNumber&&R.payCardCvv&&R.payCardExpireMonth&&R.payCardExpireYear))console.warn("Skipping Spreedly tokenization - fields not ready");else if("object"==typeof Spreedly){var a={first_name:R.donorFirstname,last_name:R.donorLastname,month:R.payCardExpireMonth,year:R.payCardExpireYear};R.donorPostCode&&(a.zip=R.donorPostCode),console.log("tokenOptions",a),Spreedly.tokenizeCreditCard(a)}else console.error("NO SPREEDLY OBJECT - Skipping Spreedly tokenization")}function H(a){for(var b=0;b<a.length;b++);}function I(){var b="";if("bitcoin"==window.mwdspace.userInputData.payMethod)b=a.bitcoin;else if("card"==window.mwdspace.userInputData.payMethod)switch(window.mwdspace.userInputData.cardType){case"visa":b=a.visa;break;case"mastercard":b=a.mastercard;break;case"amex":b=a.amex;break;case"discover":b=a.discover;}var c=T.find("section[data-step-name=\"processing\"]");c.find("span.processingPaySymbol").html(b),d("processing")}function J(a){if("object"!=typeof a)return console.warn("prepAndShowBitcoinStep() given invalid input",a),void N("Unable to display Bitcoin invoice screen");var b=T.find("section[data-step-name=\"bitcoinInvoice\"]");b.find("span.bitcoinStatus").html(a.invoice_status),b.find("img.scanCode").attr("src","data:image/png;charset=utf-8;base64,"+a.img_data),b.find("span.bitcoinAmount").html(a.alt_amount),b.find("span.bitcoinWalletLink").html(a.checkout_url),b.find("a.bitcoinWalletLink").attr("href",a.checkout_url),K(a.exp),P.intervals.bitcoinTimer=setInterval(function(){K(a.exp)},1e3),d("bitcoinInvoice"),P.intervals.bitcoinStatusChecker=setInterval(function(){L(a.transaction_id)},3e4)}function K(a){if("undefined"==typeof a)var a=null;var b="Unknown time";try{var c=0,d=0,e=new Date(a).getTime(),f=new Date().getTime(),g=(e-f)/1e3/60;0<g?(c=parseInt(g),d=parseInt(60*(g-c)),2>g&&ba.closest("div.bitcoinStatusDisplay").addClass("warning")):(ba.closest("div.bitcoinStatusDisplay").addClass("error"),clearInterval(P.intervals.bitcoinTimer)),10>d&&(d="0"+d),b=c.toFixed()+":"+d}catch(a){console.warn("updateBitcoinTimer() caught error",a.message)}ba.html(b)}async function L(a){if(console.log(">>> checkBitcoinPaymentStatus()"),"undefined"==typeof a){console.warn("checkBitcoinPaymentStatus() given empty url");var a=null}var b=T.find("div.bitcoinContainer"),c=await new Promise(function(b){console.log(">>> checkBitcoinPaymentStatus() INSIDE PROMISE"),"string"!=typeof a&&(console.warn("checkBitcoinPaymentStatus() given invalid url type:",typeof a,a),b(null)),console.log("checkBitcoinPaymentStatus() start:",a);var c=encodeURI("https://bitpay.com/invoices/"+a),d=new XMLHttpRequest;d.addEventListener("load",function(a){var c=a.target.responseText||a.target.response||null,d=window.mwdspace.sharedUtils.safeJsonParse(c);d&&d.data||(console.log("checkBitcoinPaymentStatus(): invalid response",a),b(null)),b(d.data)}),d.addEventListener("error",function(a){console.error("checkBitcoinPaymentStatus() ERROR EVENT",c,a),b(null)}),d.addEventListener("abort",function(a){console.warn("checkBitcoinPaymentStatus() ABORT EVENT",c,a),b(null)}),d.open("get",c,!0),d.setRequestHeader("Accept","application/json"),d.send()});if(!c){var d="<div class='spacingContainer error'>Warning: Unable to check the status of this invoice ("+new Date().toLocaleTimeString()+"). Will try again shortly.</div>";return void b.find("div.bitcoinFeedback").html(d)}switch(console.log("checkBitcoinPaymentStatus() RESPONSE",c),b.find("div.bitcoinStatus").html(c.status),c.status){case"paid":case"confirmed":case"complete":M(),clearInterval(P.intervals.bitcoinStatusChecker);break;case"expired":N("The Bitcoin invoice expired before payment was received."),clearInterval(P.intervals.bitcoinStatusChecker);break;case"invalid":var e=document.createElement("div");e.innerHTML="The invoice received payments, but is listed as invalid.",Q(e).addClass("spacingContainer error"),b.find("div.bitcoinFeedback").append(e);}}function M(a){if("undefined"==typeof a)var a={};var b=window.mwdspace.userInputData.firstName||"",c=document.createElement("strong");c.innerHTML=b;var e=T.find("section[data-step-name=\"confirmation\"]");e.find("span.transactionSuccessName").append(c).append("!"),d("confirmation")}function N(a){if("undefined"==typeof a)var a={};var b=T.find("section[data-step-name=\"processError\"]");b.find("span.errorDescription").html(a),d("processError")}function O(a){if(P.isLoaded){a=Q(a);var b=Q(window).scrollTop(),c=Q(window).height(),d=b,e=(a.outerHeight()-a.innerHeight())/2;e=0>=e?4:e;var f=a.offset().top+e,g=f+a.innerHeight();return a.innerHeight()>c?void Q("html,body").animate({scrollTop:f,easing:"ease"},666):d>f?void Q("html,body").animate({scrollTop:f,easing:"ease"},999):void(d+c<g&&Q("html,body").animate({scrollTop:g-c+e,easing:"ease"},999))}}var P=this;"function"!=typeof P.jquery&&(console.error("jQuery (thisWidget.jquery) not found"),exit());var Q=P.jquery;console.log("MFA_Funraise_Widget using jQuery version",Q.fn.jquery),window.mwdspace.userInputData={};var R=window.mwdspace.userInputData;P.defaultGiftList=[25,50,75,100];var S=P.options.paymentTokenizerId||"ODBm2idmYFT3pBge5qxRBjQaWH9",T=Q("div.giftFormContainer"),U=T.find("section.step"),V=T.find("button.goPreviousStep"),W=T.find("select[name=\"payMethod\"]"),X=T.find("select[name=\"donorRegion\"]"),Y=T.find("input[name=\"donorRegion\"]"),Z=T.find("div.giftOption input"),_=T.find("select[name=\"giftCurrency\"]"),aa=T.find("div.payInfoContainer div.cardNumberFeedback"),ba=T.find("div.bitcoinContainer span.bitcoinTimeRemaining");P.promises.labelOverrideLoad=P.prepareLabelOverride(),function(a){if("undefined"==typeof a)var a={};"object"!=typeof a&&(a={},console.warn("buildCurrencySelect(): ignoring invalid option object",a));var b="string"==typeof a.default?a.default:"USD";try{if(!window.mwdspace.validCurrencyList)throw new Error("List of valid currencies not found");var c=_;if(1!==c.length)throw new Error("Unable to identify the currency select dropdown");for(var d,e,f,g=0;g<window.mwdspace.validCurrencyList.length;g++)f=!0,e=window.mwdspace.validCurrencyList[g],a.filterList&&(f=H(a.filterList,e.code)),f&&(d=v(e),d?c.append(d):console.warn("Unable to add currency:",e));c.val(b).trigger("change")}catch(a){console.error("Unable to build the currency select dropdown",a)}}(),function(){try{if(!window.mwdspace.validPayMethodList)throw new Error("List of valid payment methods not found");if(1!==W.length)throw new Error("Unable to identify the payment method select dropdown");for(var a,b=0;b<window.mwdspace.validPayMethodList.length;b++)a=w(window.mwdspace.validPayMethodList[b]),a?W.append(a):console.warn("Unable to add payment method:",window.mwdspace.validPayMethodList[b]);1<window.mwdspace.validPayMethodList.length?W.show():W.hide()}catch(a){console.error("Unable to build the payment method select dropdown",a)}}(),function(){try{if(!window.mwdspace.validFrequencyList||1>window.mwdspace.validFrequencyList.length)throw new Error("Invalid list of frequencies given");var a=T.find("div.giftFrequencyContainer");if(1!==a.length)throw new Error("Unable to identify the frequency container");a.find("div.fancyRadioButton").remove();for(var b,c=0;c<window.mwdspace.validFrequencyList.length;c++)b=x(window.mwdspace.validFrequencyList[c],{id:window.mwdspace.sharedUtils.makeUniqueId("frequency-"+c)}),b?a.append(b):console.warn("Unable to add frequency:",window.mwdspace.validFrequencyList[c])}catch(a){console.error("Unable to build the frequency buttons",a)}}(),q(),function(a){if("undefined"==typeof a)var a={};"object"!=typeof a&&(a={},console.warn("buildCountrySelect(): ignoring invalid option object",a));var b="string"==typeof a.default?a.default:"US";try{if(!window.mwdspace.validCountryList)throw new Error("List of valid countries not found");var c=T.find("select[name=\"donorCountry\"]");if(c.on("change",y),1!==c.length)throw new Error("Unable to identify the country select dropdown");for(var d,e,f,g=0;g<window.mwdspace.validCountryList.length;g++)f=!0,e=window.mwdspace.validCountryList[g],a.filterList&&(f=H(a.filterList,e.code)),f&&(d=C(e),d?c.append(d):console.warn("Unable to add country:",e));c.val(b).trigger("change")}catch(a){console.error("Unable to build the country select dropdown",a)}}(),async function(){P.promises.spreedlyIframeScript&&(await P.promises.spreedlyIframeScript);var a="Enter your company name";try{P.labelOverride.donor.matchCompanyPlaceholder&&(a=P.labelOverride.donor.matchCompanyPlaceholder)}catch(a){}Q("select[name=\"donorMatchCompany\"]").select2({minimumInputLength:3,delay:400,placeholder:a,width:"100%",ajax:{url:"https://platform.funraise.io/api/v1/ddcompanies",data:function(a){var b={q:a.term};return b},processResults:function(a){var b={results:[]};if("object"==typeof a&&a.length)for(var c=0;c<a.length;c++)a[c].name&&b.results.push({id:a[c].name,text:a[c].name});return b}}})}(),function(){try{var a=T.find("select[name=\"payCardExpireMonth\"]");if(1!==a.length)throw new Error("Unable to identify the card expire month select dropdown");var b=D("Month",{value:"","data-label-id":"payment.cardExpireMonthPlaceholder"});a.append(b);for(var c=1;12>=c;c++)b=D(c),b?a.append(b):console.warn("Unable to add card expire month:",c)}catch(a){console.error("Unable to build the card expire month select dropdown",a)}}(),function(){try{var a=new Date;a.setDate(a.getDate()-7);var b=a.getFullYear(),c=T.find("select[name=\"payCardExpireYear\"]");if(1!==c.length)throw new Error("Unable to identify the card expire year select dropdown");var d=E("Year",{value:"","data-label-id":"payment.cardExpireYearPlaceholder"});c.append(d);for(var e=b;e<b+15;e++)d=E(e),d?c.append(d):console.warn("Unable to add card expire year:",e)}catch(a){console.error("Unable to build the card expire year select dropdown",a)}}(),await P.promises.labelOverrideLoad,P.labelOverride&&P.processLabelOverride(P.labelOverride),d(),function(){Q(document).on("change blur",function(a){var b=Q(a.target),c=b.attr("name"),d=b.val(),e=(b.prop("tagName")+"").toLowerCase();if(b.hasClass("changeWatch")&&h(b,{name:c,value:d}),"giftAmountFixed"==c&&"input"==e)j(a);else if("giftAmountFreeform"==c&&"input"==e){Z.prop("checked",!1);var f=t(d)||0,g=f.toFixed(2);g!=d&&b.val(g),0>f||f<window.mwdspace.userInputData.minimumAmount?b.addClass("invalid"):b.removeClass("invalid"),j(a)}else"giftCurrency"==c&&"select"==e?l():"payMethod"==c&&"select"==e?m():"giftFrequency"==c&&"input"==e&&n();console.log(window.mwdspace.userInputData)}),T.find("div.giftOption input[name=\"giftAmountFreeform\"]").on("focus keyup paste",function(a){j(a)}),_.trigger("change"),W.trigger("change"),T.trigger("change"),T.find("input#inputCompanyMatch").change(function(){Q(this).prop("checked")?T.find("div#collapsableCompanyMatch").slideDown(666,function(){O(T)}):T.find("div#collapsableCompanyMatch").slideUp(333,function(){O(T)})}).trigger("change")}(),async function(){P.promises.spreedlyIframeScript?(await P.promises.spreedlyIframeScript,Spreedly.on("ready",function(){console.log("\n\nSPREEDLY READY",Spreedly),Spreedly.setPlaceholder("number","Card"),Spreedly.setFieldType("number","text"),Spreedly.setNumberFormat("prettyFormat"),Spreedly.setPlaceholder("cvv","CVV"),F()}),Spreedly.on("paymentMethod",function(a,b){console.log("\n\nSPREEDLY PAYMENT TOKENIZED",a,b),window.mwdspace.userInputData.paymentToken=a,window.mwdspace.userInputData.cardType=b.card_type,window.mwdspace.userInputData.cardLastFour=b.last_four_digits}),Spreedly.on("errors",function(a){console.log("\n\nSPREEDLY REPORTS ERRORS:");for(var b,c=0;c<a.length;c++)b=a[c],console.log(b)}),Spreedly.on("fieldEvent",function(b,c,d,e){if(console.log("activeEl",d),"input"==c&&(console.log("CARD NUMBER EVENT",e),e.validNumber&&e.validCvv&&console.log("BOTH FIELDS VALID"),"number"==b)){e.validNumber?aa.find("span.cardNumberValidity").removeClass("invalid").addClass("valid").html("<i class=\"fas fa-check-circle\"></i>"):aa.find("span.cardNumberValidity").removeClass("valid").addClass("invalid").html("<i class=\"fas fa-times\"></i>");var f;switch(e.cardType){case"visa":f=a.visa;break;case"master":f=a.mastercard;break;case"american_express":f=a.amex;break;case"discover":f=a.discover;break;default:f=a.card;}console.log("Changing card type to",f),aa.find("span.cardType").html(f)}}),Spreedly.init(S,{numberEl:"cardNumberTarget",cvvEl:"cardCvvTarget"})):console.error("Spreedly load not found - Skipping Spreedly setup")}(),setTimeout(function(){P.isLoaded=!0},999),document.addEventListener("click",function(a){var e=Q(a.target).closest("button, .clickTarget");e&&(e.hasClass("processDonation")?window.mwdspace.donationInProgress?alert("A donation is processing."):(window.mwdspace.transactionSendData=o(),window.mwdspace.transactionLayer.validateSendData(window.mwdspace.transactionSendData)?(I(),p(e)):(window.mwdspace.donationInProgress=!1,e.addClass("showInvalid"),setTimeout(function(){e.removeClass("showInvalid")},1500))):e.hasClass("goNextStep")?!b()&&(e.addClass("showInvalid"),setTimeout(function(){e.removeClass("showInvalid")},1500)):e.hasClass("goPreviousStep")?c():e.hasClass("errorRestart")&&d("giftAmount"))})},window.mwdspace.MFA_Funraise_Widget.prototype.linkExternalStylesheet=function(a){var b=this;return new Promise(function(c){var d=document.createElement("link");b.targetElement.appendChild(d),d.rel="stylesheet",d.type="text/css";var e=setTimeout(function(){console.log("linkExternalStylesheet() No load after 5s",a),c(!1)},5e3);d.addEventListener("load",function(){clearTimeout(e),c(!0)}),d.addEventListener("error",function(b){console.error("linkExternalStylesheet() ERROR EVENT",a,b),c(!1)}),d.addEventListener("abort",function(b){console.warn("linkExternalStylesheet() ABORT EVENT",a,b),c(!1)}),d.href=encodeURI(a)})},window.mwdspace.MFA_Funraise_Widget.prototype.linkExternalScript=function(a){var b=this;return new Promise(function(c){var d=document.createElement("script");b.targetElement.appendChild(d);var e=setTimeout(function(){console.log("linkExternalScript() No load after 5s",a),c(!1)},5e3);d.addEventListener("load",function(){clearTimeout(e),c(!0)}),d.addEventListener("error",function(b){clearTimeout(e),console.error("linkExternalScript() ERROR",a,b),c(!1)}),d.addEventListener("abort",function(b){clearTimeout(e),console.warn("linkExternalScript() ABORTED",a,b),c(!1)}),d.src=encodeURI(a)})},window.mwdspace.MFA_Funraise_Widget.prototype.loadFile=function(a){this;return new Promise(function(b){"undefined"==typeof a&&(console.warn("loadFile() given empty url"),b(null)),"string"!=typeof a&&(console.warn("loadFile() given invalid url type:",typeof a,a),b(null));var c=encodeURI(a),d=new XMLHttpRequest,e=setTimeout(function(){console.log("linkExternalScript() No load after 5s",url),b(!1)},5e3);d.addEventListener("load",function(a){clearTimeout(e);var c=a.target.responseText||a.target.response||null;b(c)}),d.addEventListener("error",function(a){clearTimeout(e),console.error("loadFile() ERROR EVENT",c,a),b(null)}),d.addEventListener("abort",function(a){clearTimeout(e),console.warn("loadFile() ABORT EVENT",c,a),b(null)}),d.open("get",c,!0),d.send()})},window.mwdspace.MFA_Funraise_Widget.prototype.prepareLabelOverride=function(){var a=this;return new Promise(async b=>{if(a.options.labelOverride)switch(typeof a.options.labelOverride){case"object":a.labelOverride=a.options.labelOverride,b(!0);break;case"string":try{var c=await a.loadFile(a.options.labelOverride);if(c){var d=window.mwdspace.sharedUtils.safeJsonParse(c);d?(a.labelOverride=d,b(!0)):console.error("MFA_Funraise_Widget.prepareLabelOverride() - unable to parse text override data from file:",a.options.labelOverride)}else console.error("MFA_Funraise_Widget.prepareLabelOverride() - unable to load file for text override data:",a.options.labelOverride)}catch(a){console.log("Caught error: ",a.message)}}b(!1)})},window.mwdspace.MFA_Funraise_Widget.prototype.processLabelOverride=function(a,b){var c=this;if("object"!=typeof a||!a)return console.warn("MFA_Funraise_Widget.processLabelOverride() given invalid object",typeof a),!1;if("undefined"==typeof b)var b="";"string"!=typeof b&&(console.warn("Ignoring invalid string prefix value",b),b=""),b&&(b+=".");var d;for(var e in a)d=b+e,"string"==typeof a[e]?c.setElementText(d,a[e]):c.processLabelOverride(a[e],d)},window.mwdspace.MFA_Funraise_Widget.prototype.setElementText=function(a,b){this;if("undefined"==typeof a)var a="";if(!a)return void console.warn("setElementText() given empty labelId");var c,d="[data-label-id=\""+a+"\"]",e=document.querySelectorAll(d);if(e)for(var f=0;f<e.length;f++)c=(e[f].tagName+"").toLowerCase(),"input"===c?e[f].setAttribute("placeholder",b):"label"===c||"span"===c||"div"===c||"option"===c||"h1"===c||"h2"===c||"h3"===c||"h4"===c||"h5"===c||"h6"===c||"p"===c||"li"===c?e[f].innerHTML=b:console.warn("setElementText(): Ignoring tag",a,c);else console.warn("REPLACE labelId not found",a)}})();